import java.util.*;

class Solution {
    public int minAbsDifference(int[] nums, int goal) {
        int n = nums.length;
        int mid = n / 2;

        List<Integer> leftSums = new ArrayList<>();
        List<Integer> rightSums = new ArrayList<>();

        // Generate subset sums for left half
        generate(nums, 0, mid, 0, leftSums);

        // Generate subset sums for right half
        generate(nums, mid, n, 0, rightSums);

        Collections.sort(rightSums);

        int ans = Integer.MAX_VALUE;

        for (int left : leftSums) {
            int remaining = goal - left;

            int idx = Collections.binarySearch(rightSums, remaining);

            if (idx >= 0) return 0; // exact match found

            idx = -idx - 1;

            if (idx < rightSums.size())
                ans = Math.min(ans, Math.abs(left + rightSums.get(idx) - goal));

            if (idx > 0)
                ans = Math.min(ans, Math.abs(left + rightSums.get(idx - 1) - goal));
        }

        return ans;
    }

    private void generate(int[] nums, int start, int end,
                          int sum, List<Integer> list) {
        if (start == end) {
            list.add(sum);
            return;
        }

        // include
        generate(nums, start + 1, end, sum + nums[start], list);

        // exclude
        generate(nums, start + 1, end, sum, list);
    }
}
